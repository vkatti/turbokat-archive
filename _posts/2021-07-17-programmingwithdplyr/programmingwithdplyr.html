<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Programming with R {dplyr} - As I Understand It!!</title>

  <meta property="description" itemprop="description" content="This post is about how {dplyr} functions can be used to create your own functions.."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-07-17"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-07-17"/>
  <meta name="article:author" content="Vishal Katti"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Programming with R {dplyr} - As I Understand It!!"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="This post is about how {dplyr} functions can be used to create your own functions.."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Programming with R {dplyr} - As I Understand It!!"/>
  <meta property="twitter:description" content="This post is about how {dplyr} functions can be used to create your own functions.."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","preview","output"]}},"value":[{"type":"character","attributes":{},"value":["Programming with R {dplyr} - As I Understand It!!"]},{"type":"character","attributes":{},"value":["This post is about how {dplyr} functions can be used to create your own functions..\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Vishal Katti"]}]}]},{"type":"character","attributes":{},"value":["07-17-2021"]},{"type":"character","attributes":{},"value":["Rstats","dplyr","functions"]},{"type":"character","attributes":{},"value":["https://i.gifer.com/8inO.gif"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["programmingwithdplyr_files/anchor-4.2.2/anchor.min.js","programmingwithdplyr_files/bowser-1.9.3/bowser.min.js","programmingwithdplyr_files/distill-2.2.21/template.v2.js","programmingwithdplyr_files/header-attrs-2.9/header-attrs.js","programmingwithdplyr_files/jquery-1.11.3/jquery.min.js","programmingwithdplyr_files/popper-2.6.0/popper.min.js","programmingwithdplyr_files/tippy-6.2.7/tippy-bundle.umd.min.js","programmingwithdplyr_files/tippy-6.2.7/tippy-light-border.css","programmingwithdplyr_files/tippy-6.2.7/tippy.css","programmingwithdplyr_files/tippy-6.2.7/tippy.umd.min.js","programmingwithdplyr_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="programmingwithdplyr_files/header-attrs-2.9/header-attrs.js"></script>
  <script src="programmingwithdplyr_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="programmingwithdplyr_files/popper-2.6.0/popper.min.js"></script>
  <link href="programmingwithdplyr_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="programmingwithdplyr_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="programmingwithdplyr_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="programmingwithdplyr_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="programmingwithdplyr_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="programmingwithdplyr_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="programmingwithdplyr_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Programming with R {dplyr} - As I Understand It!!","description":"This post is about how {dplyr} functions can be used to create your own functions..","authors":[{"author":"Vishal Katti","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-07-17T00:00:00.000+05:30","citationText":"Katti, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Programming with R {dplyr} - As I Understand It!!</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">Rstats</div>
<div class="dt=tag">dplyr</div>
<div class="dt=tag">functions</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>This post is about how {dplyr} functions can be used to create your own functions..</p></p>
</div>

<div class="d-byline">
  Vishal Katti  
  
<br/>07-17-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#inspiration">Inspiration</a></li>
<li><a href="#data">Data</a></li>
</ul></li>
<li><a href="#select"><code>select()</code></a>
<ul>
<li><a href="#passing-raw-column-names">Passing raw column names</a></li>
<li><a href="#passing-multiple-raw-column-names-using-argument">Passing multiple raw column names using … argument</a></li>
<li><a href="#passing-a-character-vector-of-column-names">Passing a character vector of column names</a></li>
</ul></li>
<li><a href="#filter"><code>filter()</code></a>
<ul>
<li><a href="#passing-single-raw-criteria">Passing single raw criteria</a></li>
<li><a href="#passing-multiple-raw-criteria-using-argument">Passing multiple raw criteria using … argument</a></li>
<li><a href="#passing-single-criteria-as-a-character-string">Passing single criteria as a character string</a></li>
<li><a href="#passing-multiple-criteria-as-character-vector">Passing multiple criteria as character vector</a></li>
</ul></li>
<li><a href="#mutate"><code>mutate()</code></a>
<ul>
<li><a href="#passing-the-column-name-as-raw-name">Passing the column name as raw name</a></li>
<li><a href="#passing-the-new-variable-name-as-character-string-direct">Passing the new variable name as character string (direct)</a></li>
<li><a href="#passing-the-new-variable-name-as-character-string-indirect">Passing the new variable name as character string (indirect)</a></li>
</ul></li>
<li><a href="#arrange"><code>arrange()</code></a>
<ul>
<li><a href="#passing-single-raw-name">Passing single raw name</a></li>
<li><a href="#passing-multiple-raw-names-using-...-argument">Passing multiple raw names using <code>...</code> argument</a></li>
<li><a href="#pass-single-column-name-as-string">Pass single column name as string</a></li>
<li><a href="#pass-multiple-column-name-as-string">Pass multiple column name as string</a></li>
</ul></li>
<li><a href="#group_by"><code>group_by()</code></a>
<ul>
<li><a href="#passing-single-raw-name-1">Passing single raw name</a></li>
<li><a href="#passing-multiple-raw-names-using-the-...-operator">Passing multiple raw names using the <code>...</code> operator</a></li>
<li><a href="#passing-single-or-multiple-column-names-as-character-string">Passing single or multiple column names as character string</a></li>
</ul></li>
<li><a href="#slightly-better-examples">(Slightly Better) Examples</a>
<ul>
<li><a href="#mutate-example"><code>mutate()</code> example</a></li>
<li><a href="#group_by-example"><code>group_by()</code> example</a></li>
<li><a href="#more-ideas">More ideas</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
</nav>
</div>
<style>
d-article div.sourceCode code,
d-article pre code {
    font-family: "Fira Code", monospace;
}
</style>
<h1 id="introduction">Introduction</h1>
<p>The purpose of this document is to act as a quick guide for myself and others to understand how to use <code>dplyr</code> effectively to create dynamic functions. The general assumption is that the reader is familiar with the <code>{dplyr}</code> package and how to use it for data wrangling.</p>
<p>In this document, we will explore how to create functions using the popular <code>dplyr</code> verbs like <code>select</code>, <code>filter</code>, <code>mutate</code>, <code>arrange</code> and finally <code>group_by</code> with <code>summarise</code>.</p>
<h3 id="inspiration">Inspiration</h3>
<p>I regularly deal with event-related information with event date and few other columns like event type, root cause etc. Most reports usually involve calculating number of events that took place on a monthly, quarterly or annual basis, sometimes split by event type, root cause and other columns. After a few reports I realized that I am basically writing the same code over and over again to calculate these KPIs. Keeping the <code>DRY (Don't Repeat Yourself)</code> principle in mind, I managed to write a few functions to calculate these KPIs with a few dynamic variables. Following is an attempt to articulate what I learnt while creating those functions.</p>
<h3 id="data">Data</h3>
<p>We shall use the Texas Housing Sales data, available as a tibble in the popular <code>ggplot2</code> package as reference data. It contains monthly information about the housing market in Texas provided by the TAMU real estate center, <a href="https://www.recenter.tamu.edu/" class="uri">https://www.recenter.tamu.edu/</a>. It has 8602 observations and 9 variables.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>txhousing</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='va'><a href='https://ggplot2.tidyverse.org/reference/txhousing.html'>txhousing</a></span>
<span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://pillar.r-lib.org/reference/glimpse.html'>glimpse</a></span><span class='op'>(</span><span class='va'>txhousing</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 8,602
Columns: 9
$ city      &lt;chr&gt; &quot;Abilene&quot;, &quot;Abilene&quot;, &quot;Abilene&quot;, &quot;Abilene&quot;, &quot;Abile~
$ year      &lt;int&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 20~
$ month     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4,~
$ sales     &lt;dbl&gt; 72, 98, 130, 98, 141, 156, 152, 131, 104, 101, 100~
$ volume    &lt;dbl&gt; 5380000, 6505000, 9285000, 9730000, 10590000, 1391~
$ median    &lt;dbl&gt; 71400, 58700, 58100, 68600, 67300, 66900, 73500, 7~
$ listings  &lt;dbl&gt; 701, 746, 784, 785, 794, 780, 742, 765, 771, 764, ~
$ inventory &lt;dbl&gt; 6.3, 6.6, 6.8, 6.9, 6.8, 6.6, 6.2, 6.4, 6.5, 6.6, ~
$ date      &lt;dbl&gt; 2000.000, 2000.083, 2000.167, 2000.250, 2000.333, ~</code></pre>
</div>
<p>We shall refer the above data in all the following sections.</p>
<h1 id="select"><code>select()</code></h1>
<p>When using <code>dplyr</code> functions, the two most popular ways to pass column names is either as bare names i.e. column names without enclosing them in quotes like <code>sales</code> or <code>volume</code> OR pass them as a character string like “sales” or ‘volume’. You could also pass a character vector like <code>c("sales", "volume")</code>. In this section we will explore the 3 ways to dynamically select the columns we want.</p>
<h3 id="passing-raw-column-names">Passing raw column names</h3>
<p>In this method, we pass the raw name of the column we want to select and use the <code>embrace</code> of curly-curly brackets to pass the raw name. For multiple columns, we can pass the raw names as a single vector.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>select_raw</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>var</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='op'>{</span><span class='op'>{</span><span class='va'>var</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span> <span class='op'>%&gt;%</span>     <span class='co'># embrace of curly-curly {{}} brackets</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>                                   <span class='co'># to limit the number of output rows in this example.</span>
<span class='op'>}</span>
<span class='fu'>select_raw</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>sales</span><span class='op'>)</span>                 <span class='co'># pass single raw name</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 1
  sales
  &lt;dbl&gt;
1    72
2    98
3   130
4    98
5   141
6   156</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>select_raw</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>sales</span>, <span class='va'>volume</span><span class='op'>)</span><span class='op'>)</span>      <span class='co'># pass a vector of raw names for multiple columns</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 2
  sales   volume
  &lt;dbl&gt;    &lt;dbl&gt;
1    72  5380000
2    98  6505000
3   130  9285000
4    98  9730000
5   141 10590000
6   156 13910000</code></pre>
</div>
<p>If passing multiple raw names as vector as in the <code>select_raw()</code> feels like an unnecessary complication, try the next method.</p>
<h3 id="passing-multiple-raw-column-names-using-argument">Passing multiple raw column names using … argument</h3>
<p>In this method, we use the <code>…</code> argument to pass the raw names of the columns we want to select.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>my_select</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>my_select</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>sales</span>, <span class='va'>volume</span><span class='op'>)</span>          <span class='co'># pass multiple raw names directly</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 2
  sales   volume
  &lt;dbl&gt;    &lt;dbl&gt;
1    72  5380000
2    98  6505000
3   130  9285000
4    98  9730000
5   141 10590000
6   156 13910000</code></pre>
</div>
<h3 id="passing-a-character-vector-of-column-names">Passing a character vector of column names</h3>
<p>If we have the column names as a character vector, we use the <code>all_of</code> function to pass the character vector to the internal <code>select</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>my_select_char</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>cols</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>my_cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sales"</span>,<span class='st'>"volume"</span><span class='op'>)</span>
<span class='fu'>my_select_char</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>my_cols</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 2
  sales   volume
  &lt;dbl&gt;    &lt;dbl&gt;
1    72  5380000
2    98  6505000
3   130  9285000
4    98  9730000
5   141 10590000
6   156 13910000</code></pre>
</div>
<h1 id="filter"><code>filter()</code></h1>
<p>In the previous section, we passed column names either as bare names or character strings. <code>filter()</code> takes one or more expressions/conditions that result in a logical vector, with same length as number of rows in the data.frame/tibble and returns only those rows for which the expression/condition returns <code>TRUE</code>. Following are 2 ways to pass these logical expressions/conditions. I’m using expression and condition interchangeably here. In this context, a condition is an expression that results in a boolean <code>TRUE/FALSE</code> result.</p>
<h3 id="passing-single-raw-criteria">Passing single raw criteria</h3>
<p>In this method, we pass the condition <code>sales &gt; 8000</code> as a raw/bare expression.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>filter_raw</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>cond</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='op'>{</span><span class='op'>{</span><span class='va'>cond</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span>        <span class='co'># embrace of curly-curly {{}} brackets</span>
<span class='op'>}</span>

<span class='fu'>filter_raw</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>sales</span> <span class='op'>&gt;</span> <span class='fl'>8000</span><span class='op'>)</span>          <span class='co'># Pass a single raw criterion</span>
</code></pre>
</div>
<pre><code># A tibble: 10 x 9
   city     year month sales    volume median listings inventory  date
   &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 Houston  2006     5  8040    1.60e9 151200    35398       5.5 2006.
 2 Houston  2006     6  8628    1.80e9 155200    36281       5.6 2006.
 3 Houston  2013     5  8439    2.12e9 186100    20526       3.3 2013.
 4 Houston  2013     7  8468    2.17e9 187800    21497       3.3 2014.
 5 Houston  2013     8  8155    2.08e9 186700    21366       3.3 2014.
 6 Houston  2014     6  8391    2.34e9 211200    19725       2.9 2014.
 7 Houston  2014     7  8391    2.28e9 199700    20214       3   2014.
 8 Houston  2014     8  8167    2.20e9 202400    20007       2.9 2015.
 9 Houston  2015     6  8449    2.49e9 222400    22311       3.2 2015.
10 Houston  2015     7  8945    2.57e9 217600    23875       3.4 2016.</code></pre>
</div>
<p>Do you think we can pass multiple bare conditions as a vector, like we did for <code>select_raw()</code> in the previous section? Let us try passing multiple raw criteria as a vector.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>filter_raw</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>sales</span> <span class='op'>&gt;</span> <span class='fl'>8000</span>, <span class='va'>year</span> <span class='op'>&gt;</span> <span class='fl'>2010</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre style="color: red;"><code>Error: Problem with `filter()` input `..1`.
i Input `..1` is `c(sales > 8000, year > 2010)`.
x Input `..1` must be of size 8602 or 1, not size 17204.
</code></pre>
</div>
<p>Passing multiple raw criteria as a vector doesn’t work like it works for <code>select_raw()</code> function. Let us understand why. Consider the following code:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>A</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>TRUE</span>, <span class='cn'>TRUE</span><span class='op'>)</span>                           <span class='co'># boolean vector of length = 2</span>
<span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>FALSE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>                         <span class='co'># boolean vector of length = 2</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>A</span>, <span class='va'>B</span><span class='op'>)</span>
<span class='va'>X</span>
</code></pre>
</div>
<pre><code>[1]  TRUE  TRUE FALSE FALSE</code></pre>
</div>
<p>Notice that length of X is 4. Similarly, <code>sales &gt; 8000</code> evaluates to a TRUE/FALSE boolean vector of length 8602 (equal to number of rows in <code>txhousing</code>) and so does <code>year &gt; 2010</code>. So the vector <code>c(sales &gt; 8000, year &gt; 2010)</code> becomes a TRUE/FALSE boolean vector of length 17204, which results in an error.</p>
<h3 id="passing-multiple-raw-criteria-using-argument">Passing multiple raw criteria using … argument</h3>
<p>To pass multiple raw criteria, we can use the <code>...</code> argument.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>my_filter</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='va'>...</span><span class='op'>)</span>                <span class='co'># pass the dots argument</span>
  <span class='op'>}</span>

<span class='fu'>my_filter</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>sales</span> <span class='op'>&gt;</span> <span class='fl'>8000</span>, <span class='va'>year</span> <span class='op'>&gt;</span> <span class='fl'>2010</span><span class='op'>)</span> <span class='co'># pass multiple raw criteria</span>
</code></pre>
</div>
<pre><code># A tibble: 8 x 9
  city     year month sales     volume median listings inventory  date
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Houston  2013     5  8439 2121508529 186100    20526       3.3 2013.
2 Houston  2013     7  8468 2168720825 187800    21497       3.3 2014.
3 Houston  2013     8  8155 2083377894 186700    21366       3.3 2014.
4 Houston  2014     6  8391 2342443127 211200    19725       2.9 2014.
5 Houston  2014     7  8391 2278932511 199700    20214       3   2014.
6 Houston  2014     8  8167 2195184825 202400    20007       2.9 2015.
7 Houston  2015     6  8449 2490238594 222400    22311       3.2 2015.
8 Houston  2015     7  8945 2568156780 217600    23875       3.4 2016.</code></pre>
</div>
<h3 id="passing-single-criteria-as-a-character-string">Passing single criteria as a character string</h3>
<p>By default, <code>dplyr::filter()</code> does not accept conditions as character strings. Following is an example which results in error</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='st'>"sales &gt; 8000"</span><span class='op'>)</span>
</code></pre>
</div>
<pre style="color: red;"><code>Error: Problem with `filter()` input `..1`.
i Input `..1` is `"sales > 8000"`.
x Input `..1` must be a logical vector, not a character.
</code></pre>
</div>
<p>We need to convert the character condition into a raw expression.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>my_filter_string</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>cond</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'><a href='https://rdrr.io/r/base/eval.html'>eval</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/parse.html'>parse</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='va'>cond</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>   <span class='co'># convert text to raw criterion</span>
<span class='op'>}</span>

<span class='fu'>my_filter_string</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='st'>"sales &gt; 8000"</span><span class='op'>)</span>             <span class='co'># pass single text string as criteria</span>
</code></pre>
</div>
<pre><code># A tibble: 10 x 9
   city     year month sales    volume median listings inventory  date
   &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 Houston  2006     5  8040    1.60e9 151200    35398       5.5 2006.
 2 Houston  2006     6  8628    1.80e9 155200    36281       5.6 2006.
 3 Houston  2013     5  8439    2.12e9 186100    20526       3.3 2013.
 4 Houston  2013     7  8468    2.17e9 187800    21497       3.3 2014.
 5 Houston  2013     8  8155    2.08e9 186700    21366       3.3 2014.
 6 Houston  2014     6  8391    2.34e9 211200    19725       2.9 2014.
 7 Houston  2014     7  8391    2.28e9 199700    20214       3   2014.
 8 Houston  2014     8  8167    2.20e9 202400    20007       2.9 2015.
 9 Houston  2015     6  8449    2.49e9 222400    22311       3.2 2015.
10 Houston  2015     7  8945    2.57e9 217600    23875       3.4 2016.</code></pre>
</div>
<p>The special sauce here is the <code>eval(parse(text = ...))</code> combo that converts the long text criteria into a single raw criteria and passes it to the internal <code>filter()</code> function.</p>
<h3 id="passing-multiple-criteria-as-character-vector">Passing multiple criteria as character vector</h3>
<p>What if want to pass multiple criteria as a string vector? In such a situation, we must combine all the string conditions into a single long string condition using <code>paste0(..., collapse = " &amp; ")</code>. The <code>paste0("(", cond, ")", collapse = " &amp; ")</code> combines all the criteria into a single long criteria, but still a text string.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>my_filter_strings</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>cond</span><span class='op'>)</span> <span class='op'>{</span> 
  <span class='va'>filter_text</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"("</span>, <span class='va'>cond</span>, <span class='st'>")"</span>, collapse <span class='op'>=</span> <span class='st'>" &amp; "</span><span class='op'>)</span>   <span class='co'># combine all criteria</span>
  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='st'>"Filter Condition: "</span>, <span class='va'>filter_text</span><span class='op'>)</span>                <span class='co'># (OPTIONAL) show the combined filter string</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'><a href='https://rdrr.io/r/base/eval.html'>eval</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/parse.html'>parse</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='va'>filter_text</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='co'># convert text to raw criterion</span>
  <span class='op'>}</span>

<span class='va'>my_filter_criteria</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sales &gt; 8000"</span>, <span class='st'>"year &gt; 2010"</span><span class='op'>)</span>
<span class='fu'>my_filter_strings</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>my_filter_criteria</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 8 x 9
  city     year month sales     volume median listings inventory  date
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Houston  2013     5  8439 2121508529 186100    20526       3.3 2013.
2 Houston  2013     7  8468 2168720825 187800    21497       3.3 2014.
3 Houston  2013     8  8155 2083377894 186700    21366       3.3 2014.
4 Houston  2014     6  8391 2342443127 211200    19725       2.9 2014.
5 Houston  2014     7  8391 2278932511 199700    20214       3   2014.
6 Houston  2014     8  8167 2195184825 202400    20007       2.9 2015.
7 Houston  2015     6  8449 2490238594 222400    22311       3.2 2015.
8 Houston  2015     7  8945 2568156780 217600    23875       3.4 2016.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>my_filter_criteria_with_OR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sales &gt; 8000 | sales &lt; 50"</span>, <span class='st'>"year &gt; 2010"</span><span class='op'>)</span>

<span class='co'># NOTE: OR criteria must be a single string separated by pipe '|' as in example below.</span>
<span class='fu'>my_filter_strings</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>my_filter_criteria_with_OR</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 315 x 9
   city      year month sales   volume median listings inventory  date
   &lt;chr&gt;    &lt;int&gt; &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 Brownsv~  2011     1    48   4.97e6  83300      784      12.6 2011 
 2 Brownsv~  2011     2    47   5.56e6 101400      776      12.7 2011.
 3 Brownsv~  2011     7    47   4.81e6  91200      749      13.1 2012.
 4 Brownsv~  2011    12    39   4.20e6  86800      726      12.4 2012.
 5 Brownsv~  2012     1    43   3.89e6  85000      791      13.6 2012 
 6 Brownsv~  2012     3    27   2.98e6  93800      734      13.3 2012.
 7 Brownsv~  2012    11    41   5.12e6  99000      807      14   2013.
 8 Brownsv~  2013    11    38   4.82e6 108000      859      13.4 2014.
 9 Brownsv~  2015     1    41   5.40e6  97000      733      10.7 2015 
10 Galvest~  2011     1    43   8.88e6 170000     1015      13.7 2011 
11 Galvest~  2012     1    39   5.82e6 122500     1004      13.3 2012 
12 Galvest~  2013     1    45   1.02e7 165000      792       9.7 2013 
13 Galvest~  2014     1    48   9.97e6 176700      718       8.4 2014 
14 Galvest~  2015     1    43   1.08e7 187500      575       5.8 2015 
15 Harling~  2011     4    36   5.35e6 133300      417       6.2 2011.
16 Harling~  2012    11    44   5.41e6 103300     1635      22.4 2013.
17 Harling~  2013     1    44   5.51e6  90000     1593      22.3 2013 
18 Houston   2013     5  8439   2.12e9 186100    20526       3.3 2013.
19 Houston   2013     7  8468   2.17e9 187800    21497       3.3 2014.
20 Houston   2013     8  8155   2.08e9 186700    21366       3.3 2014.
21 Houston   2014     6  8391   2.34e9 211200    19725       2.9 2014.
22 Houston   2014     7  8391   2.28e9 199700    20214       3   2014.
23 Houston   2014     8  8167   2.20e9 202400    20007       2.9 2015.
24 Houston   2015     6  8449   2.49e9 222400    22311       3.2 2015.
25 Houston   2015     7  8945   2.57e9 217600    23875       3.4 2016.
26 Kerrvil~  2011     1    31   7.11e6 170000      777      22.2 2011 
27 Kerrvil~  2011     2    22   3.70e6 140000      788      22.5 2011.
28 Kerrvil~  2011     3    27   4.65e6 134000      842      24.5 2011.
29 Kerrvil~  2011     4    35   5.62e6 143300      856      24.8 2011.
30 Kerrvil~  2011     5    39   6.60e6 155000      875      25.5 2011.
# ... with 285 more rows</code></pre>
</div>
<h1 id="mutate"><code>mutate()</code></h1>
<p><code>mutate()</code> allows you to add new columns or modify existing columns. In the example below, we will create a new column <code>volume_in_millions</code> from the existing column <code>volume</code>. The names of both the columns can be passed to the function either as raw names or character strings.</p>
<h3 id="passing-the-column-name-as-raw-name">Passing the column name as raw name</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mutate_raw</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>new_col_raw</span>, <span class='va'>old_col_raw</span>, <span class='va'>num</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='op'>{</span><span class='op'>{</span><span class='va'>new_col_raw</span><span class='op'>}</span><span class='op'>}</span> <span class='op'>:=</span> <span class='op'>{</span><span class='op'>{</span><span class='va'>old_col_raw</span><span class='op'>}</span><span class='op'>}</span><span class='op'>/</span><span class='va'>num</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>txhousing</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>city</span>, <span class='va'>year</span>, <span class='va'>month</span>, <span class='va'>volume</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate_raw</span><span class='op'>(</span><span class='va'>vol_in_millions</span>, <span class='va'>volume</span>, <span class='fl'>1E6</span><span class='op'>)</span> <span class='co'># pass raw column names w/o quotes</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 5
  city     year month   volume vol_in_millions
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;           &lt;dbl&gt;
1 Abilene  2000     1  5380000            5.38
2 Abilene  2000     2  6505000            6.50
3 Abilene  2000     3  9285000            9.28
4 Abilene  2000     4  9730000            9.73
5 Abilene  2000     5 10590000           10.6 
6 Abilene  2000     6 13910000           13.9 </code></pre>
</div>
<h3 id="passing-the-new-variable-name-as-character-string-direct">Passing the new variable name as character string (direct)</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mutate_text</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>new_col_str</span>, <span class='va'>old_col_str</span>, <span class='va'>num</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='op'>{</span><span class='op'>{</span><span class='va'>new_col_str</span><span class='op'>}</span><span class='op'>}</span> <span class='op'>:=</span> <span class='va'>df</span><span class='op'>[[</span><span class='va'>old_col_str</span><span class='op'>]</span><span class='op'>]</span><span class='op'>/</span><span class='va'>num</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>txhousing</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>city</span>, <span class='va'>year</span>, <span class='va'>month</span>, <span class='va'>volume</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate_text</span><span class='op'>(</span><span class='st'>"vol_in_millions"</span>, <span class='st'>"volume"</span>, <span class='fl'>1E6</span><span class='op'>)</span> <span class='co'># pass column names as strings</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 5
  city     year month   volume vol_in_millions
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;           &lt;dbl&gt;
1 Abilene  2000     1  5380000            5.38
2 Abilene  2000     2  6505000            6.50
3 Abilene  2000     3  9285000            9.28
4 Abilene  2000     4  9730000            9.73
5 Abilene  2000     5 10590000           10.6 
6 Abilene  2000     6 13910000           13.9 </code></pre>
</div>
<h3 id="passing-the-new-variable-name-as-character-string-indirect">Passing the new variable name as character string (indirect)</h3>
<p>Instead of passing the name of the variable as a character string as an argument, we can pass a variable containing the name of the variable. In the below example, the name of the new variable is stored in <code>new_var</code>. Using the new <code>{glue}</code> syntax, enabled by the walrus operator <code>:=</code>, we substitute the <code>new_var</code> variable with its value.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mutate_var</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>new_col_var</span>, <span class='va'>old_col_var</span>, <span class='va'>num</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='st'>"{new_col_var}"</span> <span class='op'>:=</span> <span class='va'>df</span><span class='op'>[[</span><span class='va'>old_col_var</span><span class='op'>]</span><span class='op'>]</span><span class='op'>/</span><span class='va'>num</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>new_var</span> <span class='op'>&lt;-</span> <span class='st'>"vol_in_millions"</span>
<span class='va'>old_var</span> <span class='op'>&lt;-</span> <span class='st'>"volume"</span>

<span class='va'>txhousing</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>city</span>, <span class='va'>year</span>, <span class='va'>month</span>, <span class='va'>volume</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate_var</span><span class='op'>(</span><span class='va'>new_var</span>, <span class='va'>old_var</span>, <span class='fl'>1E6</span><span class='op'>)</span>  <span class='co'># pass column names as variables</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 5
  city     year month   volume vol_in_millions
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;           &lt;dbl&gt;
1 Abilene  2000     1  5380000            5.38
2 Abilene  2000     2  6505000            6.50
3 Abilene  2000     3  9285000            9.28
4 Abilene  2000     4  9730000            9.73
5 Abilene  2000     5 10590000           10.6 
6 Abilene  2000     6 13910000           13.9 </code></pre>
</div>
<h1 id="arrange"><code>arrange()</code></h1>
<p><code>arrange()</code> sorts the rows of a data frame by the values of selected columns. By default, it sorts in Ascending order. To force a column to sort in Descending order, we must use the <code>desc()</code> function.</p>
<h3 id="passing-single-raw-name">Passing single raw name</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>arrange_raw</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>var</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='op'>{</span><span class='op'>{</span><span class='va'>var</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span> <span class='op'>%&gt;%</span>    <span class='co'># embrace of curly-curly {{}} brackets</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>arrange_raw</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>sales</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 9
  city         year month sales volume median listings inventory  date
  &lt;chr&gt;       &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 San Marcos   2011    10     6 1.16e6 180000      163       8.3 2012.
2 Harlingen    2000     7     9 1.11e6  87500      719      30.8 2000.
3 South Padr~  2011     1     9 2.09e6 225000     1258      55.7 2011 
4 San Marcos   2011     1    10 1.48e6 140000      165       7.5 2011 
5 San Marcos   2011    12    10 1.56e6 140000      148       8   2012.
6 San Marcos   2014    11    10 1.51e6 146700       96       4   2015.</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>arrange_raw</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='fu'>desc</span><span class='op'>(</span><span class='va'>sales</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 9
  city     year month sales     volume median listings inventory  date
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Houston  2015     7  8945 2568156780 217600    23875       3.4 2016.
2 Houston  2006     6  8628 1795898108 155200    36281       5.6 2006.
3 Houston  2013     7  8468 2168720825 187800    21497       3.3 2014.
4 Houston  2015     6  8449 2490238594 222400    22311       3.2 2015.
5 Houston  2013     5  8439 2121508529 186100    20526       3.3 2013.
6 Houston  2014     6  8391 2342443127 211200    19725       2.9 2014.</code></pre>
</div>
<p><code>arrange_raw()</code> fails when we pass multiple raw names as a vector.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>arrange_raw</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>sales</span>, <span class='va'>volume</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre style="color: red;"><code>Error: arrange() failed at implicit mutate() step. 
* Problem with `mutate()` column `..1`.
i `..1 = c(sales, volume)`.
i `..1` must be size 8602 or 1, not 17204.
</code></pre>
</div>
<h3 id="passing-multiple-raw-names-using-...-argument">Passing multiple raw names using <code>...</code> argument</h3>
<p>To pass multiple raw names, we must use the <code>...</code> argument.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>arrange_raw_multiple</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>arrange_raw_multiple</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>city</span>, <span class='va'>sales</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 9
  city     year month sales  volume median listings inventory  date
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Abilene  2003     1    68 5385000  70000      668       5.4  2003
2 Abilene  2011     1    68 8834493 123300      809       6.1  2011
3 Abilene  2009     1    70 8414801  92900      861       6.3  2009
4 Abilene  2000     1    72 5380000  71400      701       6.3  2000
5 Abilene  2010     1    73 9130783 112200      868       6.4  2010
6 Abilene  2001     1    75 5730000  64500      779       6.8  2001</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>arrange_raw_multiple</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>city</span>, <span class='fu'>desc</span><span class='op'>(</span><span class='va'>sales</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 9
  city     year month sales   volume median listings inventory  date
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Abilene  2015     7   268 45845730 148700      986       5   2016.
2 Abilene  2015     6   260 41396230 141500      965       5   2015.
3 Abilene  2007     7   239 29315000 114300      940       5.2 2008.
4 Abilene  2013     8   236 30777727 120000      976       5.4 2014.
5 Abilene  2014     7   231 35861350 145800     1033       5.8 2014.
6 Abilene  2005     6   230 24050000  92500      664       4.1 2005.</code></pre>
</div>
<h3 id="pass-single-column-name-as-string">Pass single column name as string</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>arrange_str</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>var</span>, <span class='va'>.desc</span> <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>.desc</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'>desc</span><span class='op'>(</span><span class='va'>df</span><span class='op'>[[</span><span class='va'>var</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='va'>df</span><span class='op'>[[</span><span class='va'>var</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>

<span class='fu'>arrange_str</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='st'>"sales"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 9
  city         year month sales volume median listings inventory  date
  &lt;chr&gt;       &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 San Marcos   2011    10     6 1.16e6 180000      163       8.3 2012.
2 Harlingen    2000     7     9 1.11e6  87500      719      30.8 2000.
3 South Padr~  2011     1     9 2.09e6 225000     1258      55.7 2011 
4 San Marcos   2011     1    10 1.48e6 140000      165       7.5 2011 
5 San Marcos   2011    12    10 1.56e6 140000      148       8   2012.
6 San Marcos   2014    11    10 1.51e6 146700       96       4   2015.</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>arrange_str</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='st'>"sales"</span>, .desc <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 9
  city     year month sales     volume median listings inventory  date
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Houston  2015     7  8945 2568156780 217600    23875       3.4 2016.
2 Houston  2006     6  8628 1795898108 155200    36281       5.6 2006.
3 Houston  2013     7  8468 2168720825 187800    21497       3.3 2014.
4 Houston  2015     6  8449 2490238594 222400    22311       3.2 2015.
5 Houston  2013     5  8439 2121508529 186100    20526       3.3 2013.
6 Houston  2014     6  8391 2342443127 211200    19725       2.9 2014.</code></pre>
</div>
<h3 id="pass-multiple-column-name-as-string">Pass multiple column name as string</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>arrange_str_multiple</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>var</span>, <span class='va'>desc</span> <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>desc</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'>desc</span><span class='op'>(</span><span class='va'>df</span><span class='op'>[</span><span class='va'>var</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span>.data <span class='op'>=</span> <span class='va'>df</span>, <span class='va'>df</span><span class='op'>[</span><span class='va'>var</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>

<span class='co'># This function arranges the dataframe either all ascending</span>
<span class='co'># or all descending. Definitely need a better example.</span>

<span class='fu'>arrange_str_multiple</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"year"</span>, <span class='st'>"month"</span>, <span class='st'>"sales"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 9
  city         year month sales volume median listings inventory  date
  &lt;chr&gt;       &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Paris        2000     1    19 1.44e6  71700      286       7.5  2000
2 San Marcos   2000     1    22 2.38e6 106700      190       6.3  2000
3 Lufkin       2000     1    28 2.28e6  68000       NA      NA    2000
4 Harlingen    2000     1    31 3.91e6  87500      644      24.9  2000
5 Galveston    2000     1    37 4.56e6  95000      636       9.1  2000
6 Port Arthur  2000     1    40 3.09e6  68300      314       5.6  2000</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>arrange_str_multiple</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"year"</span>, <span class='st'>"month"</span>, <span class='st'>"sales"</span><span class='op'>)</span>, desc <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 9
  city       year month sales   volume median listings inventory  date
  &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Houston    2015     7  8945   2.57e9 217600    23875       3.4 2016.
2 Dallas     2015     7  7038   2.02e9 233000    12292       2.4 2016.
3 Austin     2015     7  3466   1.15e9 264600     7913       3   2016.
4 San Anto~  2015     7  2962   7.05e8 198100     9462       4.1 2016.
5 Collin C~  2015     7  1861   6.14e8 292600     2809       2.1 2016.
6 Fort Bend  2015     7  1372   4.32e8 280400     3328       3.1 2016.</code></pre>
</div>
<h1 id="group_by"><code>group_by()</code></h1>
<p>In <code>group_by()</code>, we <em>select</em> which columns to, well, group by! (Damn these well-named functions!). So one can use the same techniques as <code>select()</code> to choose the columns.</p>
<p>In the following examples, we will create only one summarised value <code>total_sales</code> for simplicity.</p>
<h3 id="passing-single-raw-name-1">Passing single raw name</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>group_raw</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>grp</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>df</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>group_by</span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>grp</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>summarise</span><span class='op'>(</span>total_sales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>sales</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
              .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>group_raw</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>year</span><span class='op'>)</span>        <span class='co'># Sum of sales per year</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 2
   year total_sales
  &lt;int&gt;       &lt;dbl&gt;
1  2000      222483
2  2001      231453
3  2002      234600
4  2003      253909
5  2004      283999</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>group_raw</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>month</span><span class='op'>)</span>       <span class='co'># Sum of sales per month</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 2
  month total_sales
  &lt;int&gt;       &lt;dbl&gt;
1     1      245924
2     2      296410
3     3      386909
4     4      397332
5     5      448968</code></pre>
</div>
<h3 id="passing-multiple-raw-names-using-the-...-operator">Passing multiple raw names using the <code>...</code> operator</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>group_raw_multiple</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>df</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>summarise</span><span class='op'>(</span>total_sales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>sales</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
              .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>group_raw_multiple</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>year</span><span class='op'>)</span>              <span class='co'># Sum of sales per year</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 2
   year total_sales
  &lt;int&gt;       &lt;dbl&gt;
1  2000      222483
2  2001      231453
3  2002      234600
4  2003      253909
5  2004      283999</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>group_raw_multiple</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>year</span>, <span class='va'>month</span><span class='op'>)</span>       <span class='co'># Sum of sales per month</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 3
   year month total_sales
  &lt;int&gt; &lt;int&gt;       &lt;dbl&gt;
1  2000     1       11411
2  2000     2       15674
3  2000     3       20202
4  2000     4       18658
5  2000     5       22388</code></pre>
</div>
<h3 id="passing-single-or-multiple-column-names-as-character-string">Passing single or multiple column names as character string</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>group_str</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>grp</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>df</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>df</span><span class='op'>[</span><span class='va'>grp</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>summarise</span><span class='op'>(</span>total_sales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>sales</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
              .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>group_str</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='st'>"year"</span><span class='op'>)</span>                   <span class='co'># Sum of sales per year</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 2
   year total_sales
  &lt;int&gt;       &lt;dbl&gt;
1  2000      222483
2  2001      231453
3  2002      234600
4  2003      253909
5  2004      283999</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>group_str</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"year"</span>, <span class='st'>"month"</span><span class='op'>)</span><span class='op'>)</span>       <span class='co'># Sum of sales per month</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 3
   year month total_sales
  &lt;int&gt; &lt;int&gt;       &lt;dbl&gt;
1  2000     1       11411
2  2000     2       15674
3  2000     3       20202
4  2000     4       18658
5  2000     5       22388</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># The same column names can be passed as variables containing the character names</span>
<span class='va'>yr</span> <span class='op'>&lt;-</span> <span class='st'>"year"</span>
<span class='fu'>group_str</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>yr</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 2
   year total_sales
  &lt;int&gt;       &lt;dbl&gt;
1  2000      222483
2  2001      231453
3  2002      234600
4  2003      253909
5  2004      283999</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yrmon</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"year"</span>, <span class='st'>"month"</span><span class='op'>)</span>
<span class='fu'>group_str</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>yrmon</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 3
   year month total_sales
  &lt;int&gt; &lt;int&gt;       &lt;dbl&gt;
1  2000     1       11411
2  2000     2       15674
3  2000     3       20202
4  2000     4       18658
5  2000     5       22388</code></pre>
</div>
<p>If you want the summarise column to have a custom name like <code>total_&lt;sumvar&gt;</code>, then you can wrap the value in quotes as below. This method uses the <code>glue</code> syntax enabled by the <code>:=</code> walrus operator. The walrus operator takes either a raw name or a character string on its LHS.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>group_raw2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>grp</span>, <span class='va'>sumvar</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>df</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>group_by</span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>grp</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>summarise</span><span class='op'>(</span><span class='st'>"total_{{sumvar}}"</span> <span class='op'>:=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>sumvar</span><span class='op'>}</span><span class='op'>}</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
              .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>group_raw2</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>year</span>, <span class='va'>sales</span><span class='op'>)</span>            <span class='co'># Sum of sales per year</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 2
   year total_sales
  &lt;int&gt;       &lt;dbl&gt;
1  2000      222483
2  2001      231453
3  2002      234600
4  2003      253909
5  2004      283999</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>group_raw2</span><span class='op'>(</span><span class='va'>txhousing</span>, <span class='va'>month</span>, <span class='va'>listings</span><span class='op'>)</span>        <span class='co'># Sum of listings per month</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 2
  month total_listings
  &lt;int&gt;          &lt;dbl&gt;
1     1        1854661
2     2        1888104
3     3        1949187
4     4        1991278
5     5        2038932</code></pre>
</div>
<p>After writing so many examples, I see a pattern. <code>group_by()</code> works with techniques similar to <code>select()</code> while <code>summarise()</code> works with techniques similar to <code>mutate()</code>.</p>
<h1 id="slightly-better-examples">(Slightly Better) Examples</h1>
<p>The <code>txhousing</code> is a city-wise monthly sales and volume dataset. It has a <code>year</code> and <code>month</code> column. Let us create a <code>date</code> column and keep only those columns relevant for our custom <code>tx_summary()</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>small_df</span> <span class='op'>&lt;-</span> <span class='va'>txhousing</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>date <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/as_date.html'>as_date</a></span><span class='op'>(</span><span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"{year}-{month}-01"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>city</span>, <span class='va'>date</span>, <span class='va'>sales</span>, <span class='va'>volume</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="mutate-example"><code>mutate()</code> example</h3>
<p>Now let us create the <code>create_ymq()</code> function. This function would take 2 arguments, a data frame <code>df</code> and a raw name of a date column.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>create_ymq</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>date_col</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/class.html'>inherits</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='st'>"data.frame"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>df</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>'Date'</span><span class='op'>)</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>df</span>,
                Year <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span>,
                nHalf <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/quarter.html'>semester</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span>,
                yHalf <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/quarter.html'>semester</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span>, with_year <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
                dHalf <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/quarter.html'>semester</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span>, <span class='st'>"H"</span>, <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span>,<span class='st'>"%y"</span><span class='op'>)</span><span class='op'>)</span>,
                nQtr <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/quarter.html'>quarter</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span>,
                yQtr <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/quarter.html'>quarter</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span>, with_year <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
                dQtr <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/quarter.html'>quarter</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span>,<span class='st'>"Q"</span>, <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span>,<span class='st'>"%y"</span><span class='op'>)</span><span class='op'>)</span>,
                Month <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/month.html'>month</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span>,
                yMonth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span>, <span class='st'>"%Y.%m"</span><span class='op'>)</span><span class='op'>)</span>,
                dMonth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>date_col</span><span class='op'>}</span><span class='op'>}</span>, <span class='st'>"%b %Y"</span><span class='op'>)</span>
                <span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>create_ymq</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>small_df</span>, date_col <span class='op'>=</span> <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>glimpse</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 8,602
Columns: 14
$ city   &lt;chr&gt; &quot;Abilene&quot;, &quot;Abilene&quot;, &quot;Abilene&quot;, &quot;Abilene&quot;, &quot;Abilene&quot;~
$ date   &lt;date&gt; 2000-01-01, 2000-02-01, 2000-03-01, 2000-04-01, 2000~
$ sales  &lt;dbl&gt; 72, 98, 130, 98, 141, 156, 152, 131, 104, 101, 100, 9~
$ volume &lt;dbl&gt; 5380000, 6505000, 9285000, 9730000, 10590000, 1391000~
$ Year   &lt;dbl&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000,~
$ nHalf  &lt;int&gt; 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1,~
$ yHalf  &lt;dbl&gt; 2000.1, 2000.1, 2000.1, 2000.1, 2000.1, 2000.1, 2000.~
$ dHalf  &lt;chr&gt; &quot;1H00&quot;, &quot;1H00&quot;, &quot;1H00&quot;, &quot;1H00&quot;, &quot;1H00&quot;, &quot;1H00&quot;, &quot;2H00~
$ nQtr   &lt;int&gt; 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 1, 1, 1, 2, 2, 2,~
$ yQtr   &lt;dbl&gt; 2000.1, 2000.1, 2000.1, 2000.2, 2000.2, 2000.2, 2000.~
$ dQtr   &lt;chr&gt; &quot;1Q00&quot;, &quot;1Q00&quot;, &quot;1Q00&quot;, &quot;2Q00&quot;, &quot;2Q00&quot;, &quot;2Q00&quot;, &quot;3Q00~
$ Month  &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5,~
$ yMonth &lt;dbl&gt; 2000.01, 2000.02, 2000.03, 2000.04, 2000.05, 2000.06,~
$ dMonth &lt;chr&gt; &quot;Jan 2000&quot;, &quot;Feb 2000&quot;, &quot;Mar 2000&quot;, &quot;Apr 2000&quot;, &quot;May ~</code></pre>
</div>
<h3 id="group_by-example"><code>group_by()</code> example</h3>
<p>Now that we have a function that creates various date-related columns, let us create a function that let’s you create summary tables like annual sales per city, quarterly volumes per city etc.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tx_summary</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>grp_col</span>, <span class='va'>sum_col</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>df</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>city</span>, <span class='op'>{</span><span class='op'>{</span><span class='va'>grp_col</span><span class='op'>}</span><span class='op'>}</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>summarise</span><span class='op'>(</span><span class='st'>"total_{{sum_col}}"</span> <span class='op'>:=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span><span class='va'>sum_col</span><span class='op'>}</span><span class='op'>}</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Using these 2 functions, we can now create multiple summary tables</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>small_df_with_date_cols</span> <span class='op'>&lt;-</span> <span class='va'>small_df</span> <span class='op'>%&gt;%</span> <span class='fu'>create_ymq</span><span class='op'>(</span>date_col <span class='op'>=</span> <span class='va'>date</span><span class='op'>)</span>

<span class='co'># Annual Sales per city</span>
<span class='va'>small_df_with_date_cols</span> <span class='op'>%&gt;%</span> <span class='fu'>tx_summary</span><span class='op'>(</span>grp_col <span class='op'>=</span> <span class='va'>Year</span>, sum_col <span class='op'>=</span> <span class='va'>sales</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 736 x 3
   city      Year total_sales
   &lt;chr&gt;    &lt;dbl&gt;       &lt;dbl&gt;
 1 Abilene   2000        1375
 2 Abilene   2001        1431
 3 Abilene   2002        1516
 4 Abilene   2003        1632
 5 Abilene   2004        1830
 6 Abilene   2005        1977
 7 Abilene   2006        1997
 8 Abilene   2007        2003
 9 Abilene   2008        1651
10 Abilene   2009        1634
11 Abilene   2010        1590
12 Abilene   2011        1719
13 Abilene   2012        2016
14 Abilene   2013        2171
15 Abilene   2014        2164
16 Abilene   2015        1435
17 Amarillo  2000        2076
18 Amarillo  2001        2343
19 Amarillo  2002        2249
20 Amarillo  2003        2828
21 Amarillo  2004        3057
22 Amarillo  2005        3113
23 Amarillo  2006        3445
24 Amarillo  2007        3300
25 Amarillo  2008        3009
26 Amarillo  2009        2797
27 Amarillo  2010        2556
28 Amarillo  2011        2705
29 Amarillo  2012        2933
30 Amarillo  2013        3057
# ... with 706 more rows</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Half Yearly volumes per city</span>
<span class='va'>small_df_with_date_cols</span> <span class='op'>%&gt;%</span> <span class='fu'>tx_summary</span><span class='op'>(</span>grp_col <span class='op'>=</span> <span class='va'>yHalf</span>, sum_col <span class='op'>=</span> <span class='va'>volume</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1,472 x 3
   city    yHalf total_volume
   &lt;chr&gt;   &lt;dbl&gt;        &lt;dbl&gt;
 1 Abilene 2000.     55400000
 2 Abilene 2000.     53175000
 3 Abilene 2001.     55795000
 4 Abilene 2001.     58570000
 5 Abilene 2002.     55305000
 6 Abilene 2002.     63370000
 7 Abilene 2003.     58175000
 8 Abilene 2003.     77500000
 9 Abilene 2004.     74205000
10 Abilene 2004.     85465000
11 Abilene 2005.     94980000
12 Abilene 2005.    103875000
13 Abilene 2006.    111770000
14 Abilene 2006.    115760000
15 Abilene 2007.    121955000
16 Abilene 2007.    110107585
17 Abilene 2008.    101306055
18 Abilene 2008.     91214280
19 Abilene 2009.     95990057
20 Abilene 2009.    106367699
21 Abilene 2010.    100830738
22 Abilene 2010.     96626206
23 Abilene 2011.    101595481
24 Abilene 2011.    118570348
25 Abilene 2012.    124258849
26 Abilene 2012.    141298045
27 Abilene 2013.    140574147
28 Abilene 2013.    149706157
29 Abilene 2014.    141037003
30 Abilene 2014.    169948408
# ... with 1,442 more rows</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Quarterly Sales per city</span>
<span class='va'>small_df_with_date_cols</span> <span class='op'>%&gt;%</span> <span class='fu'>tx_summary</span><span class='op'>(</span>grp_col <span class='op'>=</span> <span class='va'>yQtr</span>, sum_col <span class='op'>=</span> <span class='va'>sales</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 2,898 x 3
   city     yQtr total_sales
   &lt;chr&gt;   &lt;dbl&gt;       &lt;dbl&gt;
 1 Abilene 2000.         300
 2 Abilene 2000.         395
 3 Abilene 2000.         387
 4 Abilene 2000.         293
 5 Abilene 2001.         305
 6 Abilene 2001.         394
 7 Abilene 2001.         401
 8 Abilene 2001.         331
 9 Abilene 2002.         295
10 Abilene 2002.         425
11 Abilene 2002.         447
12 Abilene 2002.         349
13 Abilene 2003.         298
14 Abilene 2003.         399
15 Abilene 2003.         511
16 Abilene 2003.         424
17 Abilene 2004.         385
18 Abilene 2004.         509
19 Abilene 2004.         508
20 Abilene 2004.         428
21 Abilene 2005.         419
22 Abilene 2005.         577
23 Abilene 2005.         558
24 Abilene 2005.         423
25 Abilene 2006.         414
26 Abilene 2006.         576
27 Abilene 2006.         548
28 Abilene 2006.         459
29 Abilene 2007.         484
30 Abilene 2007.         617
# ... with 2,868 more rows</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Monthly Volumes per city</span>
<span class='va'>small_df_with_date_cols</span> <span class='op'>%&gt;%</span> <span class='fu'>tx_summary</span><span class='op'>(</span>grp_col <span class='op'>=</span> <span class='va'>yMonth</span>, sum_col <span class='op'>=</span> <span class='va'>volume</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 8,602 x 3
   city    yMonth total_volume
   &lt;chr&gt;    &lt;dbl&gt;        &lt;dbl&gt;
 1 Abilene  2000.      5380000
 2 Abilene  2000.      6505000
 3 Abilene  2000.      9285000
 4 Abilene  2000.      9730000
 5 Abilene  2000.     10590000
 6 Abilene  2000.     13910000
 7 Abilene  2000.     12635000
 8 Abilene  2000.     10710000
 9 Abilene  2000.      7615000
10 Abilene  2000.      7040000
11 Abilene  2000.      7890000
12 Abilene  2000.      7285000
13 Abilene  2001.      5730000
14 Abilene  2001.      8670000
15 Abilene  2001.      9550000
16 Abilene  2001.      8705000
17 Abilene  2001.     11850000
18 Abilene  2001.     11290000
19 Abilene  2001.     13175000
20 Abilene  2001.     11840000
21 Abilene  2001.      8395000
22 Abilene  2001.      9010000
23 Abilene  2001.      8955000
24 Abilene  2001.      7195000
25 Abilene  2002.      6530000
26 Abilene  2002.      6860000
27 Abilene  2002.      8385000
28 Abilene  2002.     10465000
29 Abilene  2002.     11465000
30 Abilene  2002.     11600000
# ... with 8,572 more rows</code></pre>
</div>
<h3 id="more-ideas">More ideas</h3>
<p>You could further extend this by creating a custom filtering function that gives you, say, the rows with the highest or lowest <code>total_sales</code> or <code>total_volume</code>.</p>
<h1 id="conclusion">Conclusion</h1>
<p>The ability to create such dynamic functions, enabled by the wonderful {dplyr} package, allows us to level-up in terms of programming with R and helps make our code neat and tidy.</p>
<figure>
<img src="https://i.gifer.com/8inO.gif" alt="How I feel while creating custom functions with {dplyr}! I can almost hear the music! Source: gifer.com" /><figcaption aria-hidden="true">How I feel while creating custom functions with {dplyr}! I can almost hear the music! Source: gifer.com</figcaption>
</figure>
<h1 id="references">References</h1>
<ul>
<li>Hadley Wickham, Romain François, Lionel Henry and Kirill Müller (2021). dplyr: A Grammar of Data Manipulation. R package version 1.0.7. <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a></li>
<li><a href="https://dplyr.tidyverse.org/articles/programming.html" class="uri">https://dplyr.tidyverse.org/articles/programming.html</a></li>
<li>Garrett Grolemund, Hadley Wickham (2011). Dates and Times Made Easy with lubridate. Journal of Statistical Software, 40(3), 1-25. URL <a href="https://www.jstatsoft.org/v40/i03/" class="uri">https://www.jstatsoft.org/v40/i03/</a>.</li>
<li>H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.</li>
<li>Jim Hester (2020). glue: Interpreted String Literals. R package version 1.4.2. <a href="https://CRAN.R-project.org/package=glue" class="uri">https://CRAN.R-project.org/package=glue</a></li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
